{"title":"Pythonå·¥å…· | ç”¨pythonæŠŠexcelæˆç»©å•æ‹¼èµ·æ¥","slug":"ç”¨pythonæŠŠexcelæˆç»©å•æ‹¼èµ·æ¥","date":"2020-06-10T04:19:47.000Z","updated":"2020-06-10T04:19:47.000Z","comments":true,"path":"api/articles/ç”¨pythonæŠŠexcelæˆç»©å•æ‹¼èµ·æ¥.json","excerpt":"æ¥ä¸Šä¸€ç¯‡ï¼Œæ˜¨å¤©é™¤äº†æŠŠpdfè½¬wordï¼Œè¿˜å¾—æŠŠå‡ æ¬¡æˆç»©å•æ‹¼èµ·æ¥ï¼Œåˆå»ç™¾åº¦äº†openpyxlçš„ç”¨æ³•ï¼ŒğŸ˜‚","covers":null,"content":"<p>æ¥ä¸Šä¸€ç¯‡ï¼Œæ˜¨å¤©é™¤äº†æŠŠpdfè½¬wordï¼Œè¿˜å¾—æŠŠå‡ æ¬¡æˆç»©å•æ‹¼èµ·æ¥ï¼Œåˆå»ç™¾åº¦äº†openpyxlçš„ç”¨æ³•ï¼ŒğŸ˜‚</p>\n<span id=\"more\"></span>\n<p>ç”±äºæˆ‘æ˜¯ä¸€ä¸ªèœé¸Ÿï¼Œå¦‚æœæˆç»©å•é‡Œæœ‰äººå°‘äº†ä¸€æ¬¡æˆç»©ï¼Œé‚£ä¸ªäººçš„ä¿¡æ¯å°±é”™ä½äº†ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">from</span> openpyxl <span class=\"keyword\">import</span> Workbook   <span class=\"comment\">#pip install openpyxl</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> openpyxl <span class=\"keyword\">import</span> load_workbook</span><br><span class=\"line\"></span><br><span class=\"line\">ex=&#123;&#125;<span class=\"comment\">#å­—å…¸</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">readexcel</span>(<span class=\"params\">file</span>):</span></span><br><span class=\"line\">\twb=load_workbook(file)<span class=\"comment\">#è¯»å–excel</span></span><br><span class=\"line\">\tsheet=wb.get_sheet_by_name(wb.get_sheet_names()[<span class=\"number\">0</span>])<span class=\"comment\">#è¯»ç¬¬ä¸€ä¸ªsheetè¡¨å•</span></span><br><span class=\"line\">\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ­£åœ¨æ‰“å¼€&quot;</span>+file+<span class=\"string\">&quot;çš„&quot;</span>+sheet.title)</span><br><span class=\"line\">\tws=wb.active<span class=\"comment\">#æ¿€æ´»</span></span><br><span class=\"line\">\t<span class=\"comment\">#æ‰¾ä¸€æ‰¾å­¦å·åœ¨ç¬¬å‡ åˆ—</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">5</span>):</span><br><span class=\"line\">\t\tnav=[]</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> cell <span class=\"keyword\">in</span> <span class=\"built_in\">list</span>(sheet.rows)[i]:</span><br><span class=\"line\">\t\t\tnav.append(cell.value)</span><br><span class=\"line\">\t\t\t<span class=\"comment\">#print(nav)</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> <span class=\"string\">&quot;å­¦å·&quot;</span> <span class=\"keyword\">in</span> nav:<span class=\"comment\">#ï¼ï¼ï¼ç¡®ä¿é”®å€¼å­˜åœ¨ï¼Œä¸”å‰åæ²¡æœ‰ç©ºæ ¼</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span></span><br><span class=\"line\">\t<span class=\"keyword\">try</span>:</span><br><span class=\"line\">\t\tindex=nav.index(<span class=\"string\">&quot;å­¦å·&quot;</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">except</span>:</span><br><span class=\"line\">\t\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;Not find key!&quot;</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t<span class=\"comment\">#è¯»æ•°æ®</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> <span class=\"built_in\">list</span>(sheet.rows)[i:]:</span><br><span class=\"line\">\t\trr=[]</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> cell <span class=\"keyword\">in</span> row:</span><br><span class=\"line\">\t\t\trr.append(cell.value)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> rr[index] <span class=\"keyword\">in</span> ex.keys():</span><br><span class=\"line\">\t\t\tex[rr[index]].extend(rr)</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>:</span><br><span class=\"line\">\t\t\tex[rr[index]]=rr</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">savefile</span>(<span class=\"params\">f</span>):</span></span><br><span class=\"line\">\tpath=os.getcwd()+<span class=\"string\">&#x27;/&#x27;</span>+f</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(os.path.exists(path)):</span><br><span class=\"line\">\t\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;Error!File exists.Please delete it!&quot;</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\twb=Workbook()</span><br><span class=\"line\">\tws = wb.active  <span class=\"comment\"># é»˜è®¤ç¬¬ä¸€ä¸ªsheet</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> ex:</span><br><span class=\"line\">\t\tws.append(ex[i])</span><br><span class=\"line\">\twb.save(f)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span>():</span></span><br><span class=\"line\">\tcontents=[]</span><br><span class=\"line\">\t<span class=\"comment\">#æ–‡ä»¶åï¼Œä¸è¦è·¯å¾„</span></span><br><span class=\"line\">\tfiles=[<span class=\"string\">&#x27;1.xlsx&#x27;</span>,<span class=\"string\">&#x27;2.xlsx&#x27;</span>,<span class=\"string\">&#x27;3.xlsx&#x27;</span>]</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> f <span class=\"keyword\">in</span> files:</span><br><span class=\"line\">\t\treadexcel(f)</span><br><span class=\"line\">\t<span class=\"comment\">#print(ex)</span></span><br><span class=\"line\">\tendfile=<span class=\"string\">&quot;æ€»ç»“.xlsx&quot;</span></span><br><span class=\"line\">\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ­£åœ¨ä¿å­˜åˆ°:&quot;</span>+os.getcwd()+<span class=\"string\">&quot;/&quot;</span>+endfile)</span><br><span class=\"line\">\tsavefile(endfile)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ ==<span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">\tmain()</span><br></pre></td></tr></table></figure>","more":"<p>ç”±äºæˆ‘æ˜¯ä¸€ä¸ªèœé¸Ÿï¼Œå¦‚æœæˆç»©å•é‡Œæœ‰äººå°‘äº†ä¸€æ¬¡æˆç»©ï¼Œé‚£ä¸ªäººçš„ä¿¡æ¯å°±é”™ä½äº†ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"><span class=\"keyword\">from</span> openpyxl <span class=\"keyword\">import</span> Workbook   <span class=\"comment\">#pip install openpyxl</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> openpyxl <span class=\"keyword\">import</span> load_workbook</span><br><span class=\"line\"></span><br><span class=\"line\">ex=&#123;&#125;<span class=\"comment\">#å­—å…¸</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">readexcel</span>(<span class=\"params\">file</span>):</span></span><br><span class=\"line\">\twb=load_workbook(file)<span class=\"comment\">#è¯»å–excel</span></span><br><span class=\"line\">\tsheet=wb.get_sheet_by_name(wb.get_sheet_names()[<span class=\"number\">0</span>])<span class=\"comment\">#è¯»ç¬¬ä¸€ä¸ªsheetè¡¨å•</span></span><br><span class=\"line\">\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ­£åœ¨æ‰“å¼€&quot;</span>+file+<span class=\"string\">&quot;çš„&quot;</span>+sheet.title)</span><br><span class=\"line\">\tws=wb.active<span class=\"comment\">#æ¿€æ´»</span></span><br><span class=\"line\">\t<span class=\"comment\">#æ‰¾ä¸€æ‰¾å­¦å·åœ¨ç¬¬å‡ åˆ—</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">5</span>):</span><br><span class=\"line\">\t\tnav=[]</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> cell <span class=\"keyword\">in</span> <span class=\"built_in\">list</span>(sheet.rows)[i]:</span><br><span class=\"line\">\t\t\tnav.append(cell.value)</span><br><span class=\"line\">\t\t\t<span class=\"comment\">#print(nav)</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> <span class=\"string\">&quot;å­¦å·&quot;</span> <span class=\"keyword\">in</span> nav:<span class=\"comment\">#ï¼ï¼ï¼ç¡®ä¿é”®å€¼å­˜åœ¨ï¼Œä¸”å‰åæ²¡æœ‰ç©ºæ ¼</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span></span><br><span class=\"line\">\t<span class=\"keyword\">try</span>:</span><br><span class=\"line\">\t\tindex=nav.index(<span class=\"string\">&quot;å­¦å·&quot;</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">except</span>:</span><br><span class=\"line\">\t\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;Not find key!&quot;</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t<span class=\"comment\">#è¯»æ•°æ®</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> <span class=\"built_in\">list</span>(sheet.rows)[i:]:</span><br><span class=\"line\">\t\trr=[]</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> cell <span class=\"keyword\">in</span> row:</span><br><span class=\"line\">\t\t\trr.append(cell.value)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> rr[index] <span class=\"keyword\">in</span> ex.keys():</span><br><span class=\"line\">\t\t\tex[rr[index]].extend(rr)</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span>:</span><br><span class=\"line\">\t\t\tex[rr[index]]=rr</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">savefile</span>(<span class=\"params\">f</span>):</span></span><br><span class=\"line\">\tpath=os.getcwd()+<span class=\"string\">&#x27;/&#x27;</span>+f</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(os.path.exists(path)):</span><br><span class=\"line\">\t\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;Error!File exists.Please delete it!&quot;</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\twb=Workbook()</span><br><span class=\"line\">\tws = wb.active  <span class=\"comment\"># é»˜è®¤ç¬¬ä¸€ä¸ªsheet</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> ex:</span><br><span class=\"line\">\t\tws.append(ex[i])</span><br><span class=\"line\">\twb.save(f)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span>():</span></span><br><span class=\"line\">\tcontents=[]</span><br><span class=\"line\">\t<span class=\"comment\">#æ–‡ä»¶åï¼Œä¸è¦è·¯å¾„</span></span><br><span class=\"line\">\tfiles=[<span class=\"string\">&#x27;1.xlsx&#x27;</span>,<span class=\"string\">&#x27;2.xlsx&#x27;</span>,<span class=\"string\">&#x27;3.xlsx&#x27;</span>]</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> f <span class=\"keyword\">in</span> files:</span><br><span class=\"line\">\t\treadexcel(f)</span><br><span class=\"line\">\t<span class=\"comment\">#print(ex)</span></span><br><span class=\"line\">\tendfile=<span class=\"string\">&quot;æ€»ç»“.xlsx&quot;</span></span><br><span class=\"line\">\t<span class=\"built_in\">print</span>(<span class=\"string\">&quot;æ­£åœ¨ä¿å­˜åˆ°:&quot;</span>+os.getcwd()+<span class=\"string\">&quot;/&quot;</span>+endfile)</span><br><span class=\"line\">\tsavefile(endfile)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ ==<span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">\tmain()</span><br></pre></td></tr></table></figure>","categories":[{"name":"ä»£ç ç¼–ç¨‹","path":"api/categories/ä»£ç ç¼–ç¨‹.json"}],"tags":[{"name":"python","path":"api/tags/python.json"},{"name":"excel","path":"api/tags/excel.json"}]}