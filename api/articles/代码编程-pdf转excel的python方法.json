{"title":"Python工具 | pdf转excel的python方法","slug":"代码编程-pdf转excel的python方法","date":"2020-06-10T04:07:48.000Z","updated":"2020-06-10T04:07:48.000Z","comments":true,"path":"api/articles/代码编程-pdf转excel的python方法.json","excerpt":"最近不知道写什么了，正好昨天整理了几学期的年级排名，需要pdf转excel，所以百度学习了一下python的pdfplumber库","covers":null,"content":"<p>最近不知道写什么了，正好昨天整理了几学期的年级排名，需要pdf转excel，所以百度学习了一下python的pdfplumber库</p>\n<span id=\"more\"></span>\n<p>但是pdfplumber只能解析规整的完美的表格，那种乱七八糟的格式的表格，就不太行了，好在成绩单除了标题外，还算规整.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pdfplumber  <span class=\"comment\"># pip install pdfplumber</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> openpyxl <span class=\"keyword\">import</span> Workbook <span class=\"comment\">#pip install openpyxl</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\">wb = Workbook()  <span class=\"comment\"># 创建文件对象</span></span><br><span class=\"line\">ws = wb.active  <span class=\"comment\"># 获取第一个sheet</span></span><br><span class=\"line\">path=os.getcwd()+<span class=\"string\">&quot;/2.pdf&quot;</span> <span class=\"comment\">#当前路径下的pdf文件</span></span><br><span class=\"line\">pdf = pdfplumber.<span class=\"built_in\">open</span>(path) <span class=\"comment\">#打开pdf文件</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;开始读取数据&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#第一页第一行标题，解析只对规整的表格有用，凸(艹皿艹 )</span></span><br><span class=\"line\"><span class=\"comment\">#ws.append(pdf.pages[0].extract_tables()[0][0])</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> page <span class=\"keyword\">in</span> pdf.pages:</span><br><span class=\"line\">    <span class=\"comment\"># 获取当前页面的全部文本信息，包括表格中的文字</span></span><br><span class=\"line\">    <span class=\"comment\">#print(page.extract_text())</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> table <span class=\"keyword\">in</span> page.extract_tables():</span><br><span class=\"line\">        <span class=\"comment\"># print(table)</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> table:</span><br><span class=\"line\">            <span class=\"comment\"># print(row)</span></span><br><span class=\"line\">            <span class=\"comment\">#把列表拆了</span></span><br><span class=\"line\">            rowlist=<span class=\"built_in\">str</span>(row).replace(<span class=\"string\">&quot;[&quot;</span>,<span class=\"string\">&quot;&quot;</span>,).replace(<span class=\"string\">&quot;]&quot;</span>,<span class=\"string\">&quot;&quot;</span>).replace(<span class=\"string\">&quot;&#x27;&quot;</span>,<span class=\"string\">&quot;&quot;</span>).replace(<span class=\"string\">&quot;\\\\n&quot;</span>,<span class=\"string\">&quot;&quot;</span>).split(<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">            <span class=\"comment\">#print(rowlist)</span></span><br><span class=\"line\">            ws.append(rowlist)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;---------- 分割线 ----------&#x27;</span>)</span><br><span class=\"line\">pdf.close()</span><br><span class=\"line\"><span class=\"comment\"># 保存Excel表到22.xlsx,直接替换,注意保存</span></span><br><span class=\"line\">endfile=<span class=\"string\">&#x27;22.xlsx&#x27;</span></span><br><span class=\"line\">wb.save(endfile)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;写入excel成功&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;保存位置：&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(os.getcwd()+<span class=\"string\">&quot;/&quot;</span>+endfile)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br></pre></td></tr></table></figure>","more":"<p>但是pdfplumber只能解析规整的完美的表格，那种乱七八糟的格式的表格，就不太行了，好在成绩单除了标题外，还算规整.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pdfplumber  <span class=\"comment\"># pip install pdfplumber</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> openpyxl <span class=\"keyword\">import</span> Workbook <span class=\"comment\">#pip install openpyxl</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\">wb = Workbook()  <span class=\"comment\"># 创建文件对象</span></span><br><span class=\"line\">ws = wb.active  <span class=\"comment\"># 获取第一个sheet</span></span><br><span class=\"line\">path=os.getcwd()+<span class=\"string\">&quot;/2.pdf&quot;</span> <span class=\"comment\">#当前路径下的pdf文件</span></span><br><span class=\"line\">pdf = pdfplumber.<span class=\"built_in\">open</span>(path) <span class=\"comment\">#打开pdf文件</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;开始读取数据&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">#第一页第一行标题，解析只对规整的表格有用，凸(艹皿艹 )</span></span><br><span class=\"line\"><span class=\"comment\">#ws.append(pdf.pages[0].extract_tables()[0][0])</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> page <span class=\"keyword\">in</span> pdf.pages:</span><br><span class=\"line\">    <span class=\"comment\"># 获取当前页面的全部文本信息，包括表格中的文字</span></span><br><span class=\"line\">    <span class=\"comment\">#print(page.extract_text())</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> table <span class=\"keyword\">in</span> page.extract_tables():</span><br><span class=\"line\">        <span class=\"comment\"># print(table)</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> table:</span><br><span class=\"line\">            <span class=\"comment\"># print(row)</span></span><br><span class=\"line\">            <span class=\"comment\">#把列表拆了</span></span><br><span class=\"line\">            rowlist=<span class=\"built_in\">str</span>(row).replace(<span class=\"string\">&quot;[&quot;</span>,<span class=\"string\">&quot;&quot;</span>,).replace(<span class=\"string\">&quot;]&quot;</span>,<span class=\"string\">&quot;&quot;</span>).replace(<span class=\"string\">&quot;&#x27;&quot;</span>,<span class=\"string\">&quot;&quot;</span>).replace(<span class=\"string\">&quot;\\\\n&quot;</span>,<span class=\"string\">&quot;&quot;</span>).split(<span class=\"string\">&quot;,&quot;</span>)</span><br><span class=\"line\">            <span class=\"comment\">#print(rowlist)</span></span><br><span class=\"line\">            ws.append(rowlist)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;---------- 分割线 ----------&#x27;</span>)</span><br><span class=\"line\">pdf.close()</span><br><span class=\"line\"><span class=\"comment\"># 保存Excel表到22.xlsx,直接替换,注意保存</span></span><br><span class=\"line\">endfile=<span class=\"string\">&#x27;22.xlsx&#x27;</span></span><br><span class=\"line\">wb.save(endfile)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;写入excel成功&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;保存位置：&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(os.getcwd()+<span class=\"string\">&quot;/&quot;</span>+endfile)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\n&#x27;</span>)</span><br></pre></td></tr></table></figure>","categories":[{"name":"代码编程","path":"api/categories/代码编程.json"}],"tags":[{"name":"python","path":"api/tags/python.json"},{"name":"pdf","path":"api/tags/pdf.json"},{"name":"excel","path":"api/tags/excel.json"}]}