{"title":"标签分配 | SASM，形状自适应的样本选择策略","slug":"人工智能-SASM论文笔记","date":"2023-02-12T07:08:42.000Z","updated":"2023-02-12T07:08:42.000Z","comments":true,"path":"api/articles/人工智能-SASM论文笔记.json","excerpt":null,"covers":["https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230130190417.png","https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131100409.png","https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131102608.png","https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131111744.png","https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131111810.png"],"content":"<h1 id=\"1-论文信息\"><a href=\"#1-论文信息\" class=\"headerlink\" title=\"1. 论文信息\"></a>1. 论文信息</h1><p>论文标题：<code>《Shape-Adaptive Selection and Measurement for Oriented Object Detection》</code></p>\n<blockquote>\n<p>论文发表：AAAI 2022<br>论文链接：<a href=\"https://ojs.aaai.org/index.php/AAAI/article/view/19975\">https://ojs.aaai.org/index.php/AAAI/article/view/19975</a><br>论文代码：<a href=\"https://github.com/houliping/SASM\">https://github.com/houliping/SASM</a></p>\n</blockquote>\n<p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230130190417.png\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@inproceedings&#123;hou2022shape,</span><br><span class=\"line\">  title=&#123;Shape-adaptive selection and measurement for oriented object detection&#125;,</span><br><span class=\"line\">  author=&#123;Hou, Liping and Lu, Ke and Xue, Jian and Li, Yuqiu&#125;,</span><br><span class=\"line\">  booktitle=&#123;Proceedings of the AAAI Conference on Artificial Intelligence&#125;,</span><br><span class=\"line\">  volume=&#123;36&#125;,</span><br><span class=\"line\">  number=&#123;1&#125;,</span><br><span class=\"line\">  pages=&#123;923--932&#125;,</span><br><span class=\"line\">  year=&#123;2022&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>标签</td>\n<td>#标签分配 #旋转目标检测</td>\n</tr>\n<tr>\n<td>数据集</td>\n<td>#DOTA #HRSC2016 #UCAS-AOD #ICDAR2015</td>\n</tr>\n<tr>\n<td>目的</td>\n<td>解决旋转目标检测中样本选择没有考虑目标形状信息、没有区分不同质量正样本的问题</td>\n</tr>\n<tr>\n<td>方法</td>\n<td>提出shape-adaptive selection以及shape-adaptive measurement</td>\n</tr>\n</tbody></table>\n<h1 id=\"2-问题背景\"><a href=\"#2-问题背景\" class=\"headerlink\" title=\"2. 问题背景\"></a>2. 问题背景</h1><p>作者提到旋转目标检测仍然面临挑战，其中最主要的挑战来自目标的形状（如长宽比）。在通用目标检测任务中，样本选择（sample selection，也叫标签分配，label assignment）对于性能提升具有重要作用。然而现有的样本选择策略存在以下不足：</p>\n<ul>\n<li>忽视了目标的形状信息</li>\n<li>没有对选择的正样本的做潜在的区分</li>\n<li>大多数方法只能用于anchor-free或者anchor-based，不能同时适用</li>\n</ul>\n<h1 id=\"3-主要工作\"><a href=\"#3-主要工作\" class=\"headerlink\" title=\"3. 主要工作\"></a>3. 主要工作</h1><p>针对上述问题，作者提出了shape-adaptive selection（SA-S）和shape-adaptive measurement（SA-M）策略。</p>\n<ul>\n<li>SA-S：根据目标形状信息和特征分布动态地选择样本</li>\n<li>SA-M：度量定位能力，针对所选正样本增加质量信息</li>\n</ul>\n<h2 id=\"3-1-模型结构\"><a href=\"#3-1-模型结构\" class=\"headerlink\" title=\"3.1 模型结构\"></a>3.1 模型结构</h2><p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131100409.png\"></p>\n<h2 id=\"3-2-Motivation\"><a href=\"#3-2-Motivation\" class=\"headerlink\" title=\"3.2 Motivation\"></a>3.2 Motivation</h2><p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131102608.png\"></p>\n<p>作者做了一个实验，分析不同正负样本IoU划分阈值对不同长宽比类别性能的影响，可以发现当长宽比变大时，IoU阈值越小越好，这可以说明传统的固定IoU阈值的划分方式并不是最优的。</p>\n<h2 id=\"3-3-Shape-Adaptive-Selection\"><a href=\"#3-3-Shape-Adaptive-Selection\" class=\"headerlink\" title=\"3.3 Shape-Adaptive Selection\"></a>3.3 Shape-Adaptive Selection</h2><p>根据ATSS，目标真值和预测值的IoU均值和方法可以用于计算动态的IoU阈值，因此对于第i个真值框，IoU阈值可以计算为:<br>$$\\tau_i^{IoU}=f(y_i)\\times(\\mu+\\sigma)$$</p>\n<p>其中:<br>$$\\mu = \\frac{1}{J}\\sum\\limits^{J} _ {j=1} I _ {i,j}$$</p>\n<p>而<br>$$\\sigma=\\sqrt{\\frac{1}{J}\\sum _ {j=1}^J(I _ {i,j}-\\mu)^2}$$</p>\n<p>其中J是候选样本的数量，$I_{i,j}$是第i个真值框和第j个预测框之间的IoU值，$y_{i}$代表真值框的长宽比。 根据上面的分析，权重应该随着纵横比的增加而减小，因此长宽比较大的目标被分配一个较低的IoU阈值，故而:<br>$$f(y_i)=e^{-\\frac{y_i}{\\omega}}$$</p>\n<p>其中ω是一个权重参数，默认为4。当数据集包含大量大长宽比目标时，较大的ω通常可以获得更好的性能。这样，当IoU大于等于$\\tau_i^{IoU}$时，认为其是正样本。</p>\n<h2 id=\"3-4-Shape-Adaptive-Measurement\"><a href=\"#3-4-Shape-Adaptive-Measurement\" class=\"headerlink\" title=\"3.4 Shape-Adaptive Measurement\"></a>3.4 Shape-Adaptive Measurement</h2><p>作者认为与位于物体内部的点相比，位于物体边界附近的点包含更多关于杂波背景，甚至附近物体的信息。因此，位于物体内部的点，特别是位于物体中心周围的点，比位于物体边界附近的点更能代表物体的特征。因此如果用所有正样本都有同样的权重会导致一些高质量正样本被远离物体中心的低质量样本点抑制，且每个样本点的质量与物体的形状密切相关，而不仅仅与每个点到物体中心的距离有关。</p>\n<p>因此作者提出了一种基于归一化形状距离的Shape-Adaptive Measurement策略。其具体做法如下：<br>针对每一个真值框$(x,y,w,h,\\theta)$，其分别代表中心点坐标，宽度，高度和角度。归一化形状距离计算如下：<br>$$<br>\\Delta d _ {ij}=<br>\\begin{equation}<br>    \\begin{array}{lr}<br>         \\sqrt{\\frac{(x _ i-x _ j)^2}{w _ i}+\\frac{(y _ i-y _ j)^2}{h _ i}}, &amp; 0\\leqslant\\theta _ i\\leqslant\\frac{\\pi}{2} \\\\<br>         \\sqrt{\\frac{(x _ i-x _ j)^2}{h _ i}+\\frac{(y _ i-y _ j)^2}{w _ i}}, &amp; otherwise<br>    \\end{array}<br>\\end{equation}<br>$$<br>正样本的质量计算为$\\bar{Q} _ {ij}=e^{-\\Delta{d _ {ij}}}$.</p>\n<h2 id=\"3-5-损失函数\"><a href=\"#3-5-损失函数\" class=\"headerlink\" title=\"3.5 损失函数\"></a>3.5 损失函数</h2><p>作者认为较大偏差的孤立点会极大地影响凸包(convex hull，其由预测点集计算得到)的质量，并对精确定位产生不利影响，因此提出了边界中心损失（Boundary-Center Loss），其从点集中选取最左点、最右点、最上点和最下点，用点集中所有点的x坐标和y坐标的平均值来计算平均中心点：<br>$$L^{bc}=\\sum\\limits _ {i=1}^{5}L _ {smooth}(p _ i,g _ i)$$</p>\n<p>因此总损失为：<br>$$L=\\lambda _ 1L^c+\\lambda _ 2L^1+\\lambda _ 3L^2$$</p>\n<p>其中$L^c,L^1,L^2$分别代表分类损失，初始检测损失，精炼检测损失。$\\lambda_1,\\lambda_2,\\lambda_3$是权重系数，根据经验设为1.0，0.375和1.0. 其中分类损失计算为：<br>$$L _ i^c=\\frac{1}{N^+}\\frac{1}{\\sum _ {p _ j\\in{P^+}}\\bar{Q} _ {ij}}\\sum\\limits _ {ij}\\bar{Q} _ {ij}$$</p>\n<p>其中$j,N^+,P^+$分别代表序号，总数和预测值。$L^{cls}$代表focal loss。<br>初始检测损失为：<br>$$L^1 _ i=\\frac{1}{N^+}\\frac{1}{\\sum _ {p _ j\\in{P^+}}\\bar{Q} _ {ij}}\\sum\\limits _ {ij}\\bar{Q} _ {ij}L _ {ij}^{reg}+L^{bc} _ {ij}$$</p>\n<p>其中$L^{reg}=1-GIoU$代表GIoU Loss。<br>精炼阶段检测损失为：<br>$$L^2 _ i=\\frac{1}{N^+}\\frac{1}{\\sum _ {p _ j\\in{P^+}}\\bar{Q} _ {ij}}\\sum\\limits _ {ij}\\bar{Q} _ {ij}L _ {ij}^{reg}$$</p>\n<h1 id=\"4-实验结果\"><a href=\"#4-实验结果\" class=\"headerlink\" title=\"4. 实验结果\"></a>4. 实验结果</h1><p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131111744.png\"></p>\n<p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131111810.png\"></p>\n","more":"<h1 id=\"1-论文信息\"><a href=\"#1-论文信息\" class=\"headerlink\" title=\"1. 论文信息\"></a>1. 论文信息</h1><p>论文标题：<code>《Shape-Adaptive Selection and Measurement for Oriented Object Detection》</code></p>\n<blockquote>\n<p>论文发表：AAAI 2022<br>论文链接：<a href=\"https://ojs.aaai.org/index.php/AAAI/article/view/19975\">https://ojs.aaai.org/index.php/AAAI/article/view/19975</a><br>论文代码：<a href=\"https://github.com/houliping/SASM\">https://github.com/houliping/SASM</a></p>\n</blockquote>\n<p><img src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230130190417.png\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@inproceedings&#123;hou2022shape,</span><br><span class=\"line\">  title=&#123;Shape-adaptive selection and measurement for oriented object detection&#125;,</span><br><span class=\"line\">  author=&#123;Hou, Liping and Lu, Ke and Xue, Jian and Li, Yuqiu&#125;,</span><br><span class=\"line\">  booktitle=&#123;Proceedings of the AAAI Conference on Artificial Intelligence&#125;,</span><br><span class=\"line\">  volume=&#123;36&#125;,</span><br><span class=\"line\">  number=&#123;1&#125;,</span><br><span class=\"line\">  pages=&#123;923--932&#125;,</span><br><span class=\"line\">  year=&#123;2022&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>标签</td>\n<td>#标签分配 #旋转目标检测</td>\n</tr>\n<tr>\n<td>数据集</td>\n<td>#DOTA #HRSC2016 #UCAS-AOD #ICDAR2015</td>\n</tr>\n<tr>\n<td>目的</td>\n<td>解决旋转目标检测中样本选择没有考虑目标形状信息、没有区分不同质量正样本的问题</td>\n</tr>\n<tr>\n<td>方法</td>\n<td>提出shape-adaptive selection以及shape-adaptive measurement</td>\n</tr>\n</tbody></table>\n<h1 id=\"2-问题背景\"><a href=\"#2-问题背景\" class=\"headerlink\" title=\"2. 问题背景\"></a>2. 问题背景</h1><p>作者提到旋转目标检测仍然面临挑战，其中最主要的挑战来自目标的形状（如长宽比）。在通用目标检测任务中，样本选择（sample selection，也叫标签分配，label assignment）对于性能提升具有重要作用。然而现有的样本选择策略存在以下不足：</p>\n<ul>\n<li>忽视了目标的形状信息</li>\n<li>没有对选择的正样本的做潜在的区分</li>\n<li>大多数方法只能用于anchor-free或者anchor-based，不能同时适用</li>\n</ul>\n<h1 id=\"3-主要工作\"><a href=\"#3-主要工作\" class=\"headerlink\" title=\"3. 主要工作\"></a>3. 主要工作</h1><p>针对上述问题，作者提出了shape-adaptive selection（SA-S）和shape-adaptive measurement（SA-M）策略。</p>\n<ul>\n<li>SA-S：根据目标形状信息和特征分布动态地选择样本</li>\n<li>SA-M：度量定位能力，针对所选正样本增加质量信息</li>\n</ul>\n<h2 id=\"3-1-模型结构\"><a href=\"#3-1-模型结构\" class=\"headerlink\" title=\"3.1 模型结构\"></a>3.1 模型结构</h2><p><img src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131100409.png\"></p>\n<h2 id=\"3-2-Motivation\"><a href=\"#3-2-Motivation\" class=\"headerlink\" title=\"3.2 Motivation\"></a>3.2 Motivation</h2><p><img src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131102608.png\"></p>\n<p>作者做了一个实验，分析不同正负样本IoU划分阈值对不同长宽比类别性能的影响，可以发现当长宽比变大时，IoU阈值越小越好，这可以说明传统的固定IoU阈值的划分方式并不是最优的。</p>\n<h2 id=\"3-3-Shape-Adaptive-Selection\"><a href=\"#3-3-Shape-Adaptive-Selection\" class=\"headerlink\" title=\"3.3 Shape-Adaptive Selection\"></a>3.3 Shape-Adaptive Selection</h2><p>根据ATSS，目标真值和预测值的IoU均值和方法可以用于计算动态的IoU阈值，因此对于第i个真值框，IoU阈值可以计算为:<br>$$\\tau_i^{IoU}=f(y_i)\\times(\\mu+\\sigma)$$</p>\n<p>其中:<br>$$\\mu = \\frac{1}{J}\\sum\\limits^{J} _ {j=1} I _ {i,j}$$</p>\n<p>而<br>$$\\sigma=\\sqrt{\\frac{1}{J}\\sum _ {j=1}^J(I _ {i,j}-\\mu)^2}$$</p>\n<p>其中J是候选样本的数量，$I_{i,j}$是第i个真值框和第j个预测框之间的IoU值，$y_{i}$代表真值框的长宽比。 根据上面的分析，权重应该随着纵横比的增加而减小，因此长宽比较大的目标被分配一个较低的IoU阈值，故而:<br>$$f(y_i)=e^{-\\frac{y_i}{\\omega}}$$</p>\n<p>其中ω是一个权重参数，默认为4。当数据集包含大量大长宽比目标时，较大的ω通常可以获得更好的性能。这样，当IoU大于等于$\\tau_i^{IoU}$时，认为其是正样本。</p>\n<h2 id=\"3-4-Shape-Adaptive-Measurement\"><a href=\"#3-4-Shape-Adaptive-Measurement\" class=\"headerlink\" title=\"3.4 Shape-Adaptive Measurement\"></a>3.4 Shape-Adaptive Measurement</h2><p>作者认为与位于物体内部的点相比，位于物体边界附近的点包含更多关于杂波背景，甚至附近物体的信息。因此，位于物体内部的点，特别是位于物体中心周围的点，比位于物体边界附近的点更能代表物体的特征。因此如果用所有正样本都有同样的权重会导致一些高质量正样本被远离物体中心的低质量样本点抑制，且每个样本点的质量与物体的形状密切相关，而不仅仅与每个点到物体中心的距离有关。</p>\n<p>因此作者提出了一种基于归一化形状距离的Shape-Adaptive Measurement策略。其具体做法如下：<br>针对每一个真值框$(x,y,w,h,\\theta)$，其分别代表中心点坐标，宽度，高度和角度。归一化形状距离计算如下：<br>$$<br>\\Delta d _ {ij}=<br>\\begin{equation}<br>    \\begin{array}{lr}<br>         \\sqrt{\\frac{(x _ i-x _ j)^2}{w _ i}+\\frac{(y _ i-y _ j)^2}{h _ i}}, &amp; 0\\leqslant\\theta _ i\\leqslant\\frac{\\pi}{2} \\\\<br>         \\sqrt{\\frac{(x _ i-x _ j)^2}{h _ i}+\\frac{(y _ i-y _ j)^2}{w _ i}}, &amp; otherwise<br>    \\end{array}<br>\\end{equation}<br>$$<br>正样本的质量计算为$\\bar{Q} _ {ij}=e^{-\\Delta{d _ {ij}}}$.</p>\n<h2 id=\"3-5-损失函数\"><a href=\"#3-5-损失函数\" class=\"headerlink\" title=\"3.5 损失函数\"></a>3.5 损失函数</h2><p>作者认为较大偏差的孤立点会极大地影响凸包(convex hull，其由预测点集计算得到)的质量，并对精确定位产生不利影响，因此提出了边界中心损失（Boundary-Center Loss），其从点集中选取最左点、最右点、最上点和最下点，用点集中所有点的x坐标和y坐标的平均值来计算平均中心点：<br>$$L^{bc}=\\sum\\limits _ {i=1}^{5}L _ {smooth}(p _ i,g _ i)$$</p>\n<p>因此总损失为：<br>$$L=\\lambda _ 1L^c+\\lambda _ 2L^1+\\lambda _ 3L^2$$</p>\n<p>其中$L^c,L^1,L^2$分别代表分类损失，初始检测损失，精炼检测损失。$\\lambda_1,\\lambda_2,\\lambda_3$是权重系数，根据经验设为1.0，0.375和1.0. 其中分类损失计算为：<br>$$L _ i^c=\\frac{1}{N^+}\\frac{1}{\\sum _ {p _ j\\in{P^+}}\\bar{Q} _ {ij}}\\sum\\limits _ {ij}\\bar{Q} _ {ij}$$</p>\n<p>其中$j,N^+,P^+$分别代表序号，总数和预测值。$L^{cls}$代表focal loss。<br>初始检测损失为：<br>$$L^1 _ i=\\frac{1}{N^+}\\frac{1}{\\sum _ {p _ j\\in{P^+}}\\bar{Q} _ {ij}}\\sum\\limits _ {ij}\\bar{Q} _ {ij}L _ {ij}^{reg}+L^{bc} _ {ij}$$</p>\n<p>其中$L^{reg}=1-GIoU$代表GIoU Loss。<br>精炼阶段检测损失为：<br>$$L^2 _ i=\\frac{1}{N^+}\\frac{1}{\\sum _ {p _ j\\in{P^+}}\\bar{Q} _ {ij}}\\sum\\limits _ {ij}\\bar{Q} _ {ij}L _ {ij}^{reg}$$</p>\n<h1 id=\"4-实验结果\"><a href=\"#4-实验结果\" class=\"headerlink\" title=\"4. 实验结果\"></a>4. 实验结果</h1><p><img src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131111744.png\"></p>\n<p><img src=\"https://npm.elemecdn.com/justlovesmile-post@1.0.11/20230131111810.png\"></p>\n","categories":[{"name":"人工智能","path":"api/categories/人工智能.json"}],"tags":[{"name":"深度学习","path":"api/tags/深度学习.json"},{"name":"论文笔记","path":"api/tags/论文笔记.json"},{"name":"目标检测","path":"api/tags/目标检测.json"}]}