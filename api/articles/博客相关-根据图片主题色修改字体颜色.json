{"title":"博客相关 | 如何提取图片主题色并自动选择标题字体颜色","slug":"博客相关-根据图片主题色修改字体颜色","date":"2022-03-28T04:37:51.000Z","updated":"2022-03-28T04:37:51.000Z","comments":true,"path":"api/articles/博客相关-根据图片主题色修改字体颜色.json","excerpt":null,"covers":["https://npm.elemecdn.com/justlovesmile-img/20220328124305.png","https://npm.elemecdn.com/justlovesmile-img/20220328124527.png"],"content":"<p>今天在写博客的时候，做了一个封面图，然后<code>hexo cl &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo s</code>一键生成，点开后却发现这个标题的字体颜色亮瞎我的眼睛：</p>\n<p><img src=\"https://npm.elemecdn.com/justlovesmile-img/20220328124305.png\"></p>\n<p>于是试了很多帖子，终于把它改好了：</p>\n<p><img src=\"https://npm.elemecdn.com/justlovesmile-img/20220328124527.png\"></p>\n<p>提取主题色的js:<a href=\"https://github.com/briangonzalez/rgbaster.js\">https://github.com/briangonzalez/rgbaster.js</a></p>\n<p>处理配色js如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&#x27;post-cover&#x27;</span>)) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> img = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&#x27;post-cover&#x27;</span>).getAttribute(<span class=\"string\">&#x27;data-lazy-src&#x27;</span>)</span><br><span class=\"line\">  RGBaster.colors(img, &#123;</span><br><span class=\"line\">      <span class=\"attr\">paletteSize</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: [<span class=\"string\">&quot;rgb(255,255,255)&quot;</span>, <span class=\"string\">&quot;rgb(0,0,0)&quot;</span>, <span class=\"string\">&quot;rgb(254,254,254)&quot;</span>],</span><br><span class=\"line\">      <span class=\"attr\">success</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">t</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t.dominant != <span class=\"string\">&#x27;rgb()&#x27;</span>)&#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> c = t.dominant.match(<span class=\"regexp\">/\\d+/g</span>);</span><br><span class=\"line\">          <span class=\"keyword\">const</span> Color = <span class=\"string\">`rgba(<span class=\"subst\">$&#123;c[<span class=\"number\">0</span>]&#125;</span>,<span class=\"subst\">$&#123;c[<span class=\"number\">1</span>]&#125;</span>,<span class=\"subst\">$&#123;c[<span class=\"number\">2</span>]&#125;</span>,0.8)`</span>;</span><br><span class=\"line\">          <span class=\"keyword\">let</span> fontColor;</span><br><span class=\"line\">          <span class=\"comment\">//const grayLevel = c[0] * 0.299 + c[1] * 0.587 + c[2] * 0.114;</span></span><br><span class=\"line\">          <span class=\"keyword\">const</span> grayLevel = c[<span class=\"number\">0</span>] * <span class=\"number\">0.213</span> + c[<span class=\"number\">1</span>] * <span class=\"number\">0.715</span> + c[<span class=\"number\">2</span>] * <span class=\"number\">0.072</span>;</span><br><span class=\"line\">          <span class=\"comment\">//if (grayLevel &gt;= 190) &#123;</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (grayLevel &gt;= <span class=\"number\">255</span>/<span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 若为浅色，把文字设置为黑色</span></span><br><span class=\"line\">            fontColor = <span class=\"string\">&#x27;#000&#x27;</span>;</span><br><span class=\"line\">            metaColor = <span class=\"string\">&#x27;#1C1C1C&#x27;</span>;</span><br><span class=\"line\">          &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            fontColor = <span class=\"string\">&#x27;#fff&#x27;</span>;</span><br><span class=\"line\">            metaColor = <span class=\"string\">&#x27;#eee&#x27;</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main:&quot;</span> + Color + <span class=\"string\">&quot;!important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor:&quot;</span> + fontColor + <span class=\"string\">&quot;!important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-metacolor:&quot;</span> + metaColor + <span class=\"string\">&quot;!important&quot;</span>)</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main: rgba(255,250,240,0.5) !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor: #000 !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-metacolor: #1C1C1C !important&quot;</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">error</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main: rgba(255,250,240,0.5) !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor: #000 !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-metacolor: #1C1C1C !important&quot;</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main: transparent !important&quot;</span>)</span><br><span class=\"line\">  <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor: var(--light-grey) !important&quot;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>参考：</p>\n<ul>\n<li><a href=\"https://juejin.cn/post/6844903511956815885\">https://juejin.cn/post/6844903511956815885</a></li>\n<li><a href=\"https://blog.realwds.com/posts/84339efc.html\">https://blog.realwds.com/posts/84339efc.html</a></li>\n</ul>\n","more":"<p>今天在写博客的时候，做了一个封面图，然后<code>hexo cl &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo s</code>一键生成，点开后却发现这个标题的字体颜色亮瞎我的眼睛：</p>\n<p><img src=\"https://npm.elemecdn.com/justlovesmile-img/20220328124305.png\"></p>\n<p>于是试了很多帖子，终于把它改好了：</p>\n<p><img src=\"https://npm.elemecdn.com/justlovesmile-img/20220328124527.png\"></p>\n<p>提取主题色的js:<a href=\"https://github.com/briangonzalez/rgbaster.js\">https://github.com/briangonzalez/rgbaster.js</a></p>\n<p>处理配色js如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&#x27;post-cover&#x27;</span>)) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> img = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">&#x27;post-cover&#x27;</span>).getAttribute(<span class=\"string\">&#x27;data-lazy-src&#x27;</span>)</span><br><span class=\"line\">  RGBaster.colors(img, &#123;</span><br><span class=\"line\">      <span class=\"attr\">paletteSize</span>: <span class=\"number\">30</span>,</span><br><span class=\"line\">      <span class=\"attr\">exclude</span>: [<span class=\"string\">&quot;rgb(255,255,255)&quot;</span>, <span class=\"string\">&quot;rgb(0,0,0)&quot;</span>, <span class=\"string\">&quot;rgb(254,254,254)&quot;</span>],</span><br><span class=\"line\">      <span class=\"attr\">success</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">t</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t.dominant != <span class=\"string\">&#x27;rgb()&#x27;</span>)&#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> c = t.dominant.match(<span class=\"regexp\">/\\d+/g</span>);</span><br><span class=\"line\">          <span class=\"keyword\">const</span> Color = <span class=\"string\">`rgba(<span class=\"subst\">$&#123;c[<span class=\"number\">0</span>]&#125;</span>,<span class=\"subst\">$&#123;c[<span class=\"number\">1</span>]&#125;</span>,<span class=\"subst\">$&#123;c[<span class=\"number\">2</span>]&#125;</span>,0.8)`</span>;</span><br><span class=\"line\">          <span class=\"keyword\">let</span> fontColor;</span><br><span class=\"line\">          <span class=\"comment\">//const grayLevel = c[0] * 0.299 + c[1] * 0.587 + c[2] * 0.114;</span></span><br><span class=\"line\">          <span class=\"keyword\">const</span> grayLevel = c[<span class=\"number\">0</span>] * <span class=\"number\">0.213</span> + c[<span class=\"number\">1</span>] * <span class=\"number\">0.715</span> + c[<span class=\"number\">2</span>] * <span class=\"number\">0.072</span>;</span><br><span class=\"line\">          <span class=\"comment\">//if (grayLevel &gt;= 190) &#123;</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (grayLevel &gt;= <span class=\"number\">255</span>/<span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 若为浅色，把文字设置为黑色</span></span><br><span class=\"line\">            fontColor = <span class=\"string\">&#x27;#000&#x27;</span>;</span><br><span class=\"line\">            metaColor = <span class=\"string\">&#x27;#1C1C1C&#x27;</span>;</span><br><span class=\"line\">          &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            fontColor = <span class=\"string\">&#x27;#fff&#x27;</span>;</span><br><span class=\"line\">            metaColor = <span class=\"string\">&#x27;#eee&#x27;</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main:&quot;</span> + Color + <span class=\"string\">&quot;!important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor:&quot;</span> + fontColor + <span class=\"string\">&quot;!important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-metacolor:&quot;</span> + metaColor + <span class=\"string\">&quot;!important&quot;</span>)</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main: rgba(255,250,240,0.5) !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor: #000 !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-metacolor: #1C1C1C !important&quot;</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">error</span>: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main: rgba(255,250,240,0.5) !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor: #000 !important&quot;</span>)</span><br><span class=\"line\">          <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-metacolor: #1C1C1C !important&quot;</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">  <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-main: transparent !important&quot;</span>)</span><br><span class=\"line\">  <span class=\"built_in\">document</span>.styleSheets[<span class=\"number\">0</span>].addRule(<span class=\"string\">&quot;:root&quot;</span>, <span class=\"string\">&quot;--mj-titlecolor: var(--light-grey) !important&quot;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>参考：</p>\n<ul>\n<li><a href=\"https://juejin.cn/post/6844903511956815885\">https://juejin.cn/post/6844903511956815885</a></li>\n<li><a href=\"https://blog.realwds.com/posts/84339efc.html\">https://blog.realwds.com/posts/84339efc.html</a></li>\n</ul>\n","categories":[{"name":"博客相关","path":"api/categories/博客相关.json"}],"tags":[{"name":"前端","path":"api/tags/前端.json"},{"name":"Hexo","path":"api/tags/Hexo.json"},{"name":"JS","path":"api/tags/JS.json"}]}